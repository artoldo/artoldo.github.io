<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queen of the Lunaparking</title>
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

#terminal {
    width: 80%;
    max-width: 600px;
    height: 90vh;
    background-color: #transparent;
    padding: 20px;
    padding-bottom: 100px; /* extra space for mobile keyboard */
    border-radius: 10px;
    border: 2px solid #FF00FF; /* magenta border */
    overflow-y: auto;
    box-sizing: border-box;
    scroll-behavior: smooth;
}

#terminal:focus {
    outline: none;
}

#output {
    white-space: pre-wrap;
    margin-bottom: 10px;
    color: #FF00FF; /* main text color magenta */
}

#input-line {
    display: inline;
}

.command-color1,
.command-color2,
.command-color3 {
    color: #FF00FF; /* unify all command colors to magenta */
}

.folder {
    background-color: #FF00FF; /* folder background magenta */
    color: #000;
    padding: 5px 10px;
    border-radius: 3px;
    margin-top: 8px;
    display: inline-block;
}

.file {
    background-color: #000;
    color: #FF00FF; /* file text magenta */
    padding: 5px 10px;
    border-radius: 3px;
    margin-top: 8px;
    display: inline-block;
}

.cursor {
    animation: blink 1s steps(2, start) infinite;
    color: #FF00FF; /* cursor magenta */
}

@keyframes blink {
    50% { opacity: 0; }
}

* {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
    </style>

<!-- Starfield Background Start -->
<style>
html, body {
    margin: 0;
    padding: 0;
    background: #000;
    overflow: hidden;
}
#bgCanvas {
    position: fixed;
    inset: 0;
    margin: 0;
    padding: 0;
    z-index: -10;
    pointer-events: none;
}
#bgCanvas canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: block;
    pointer-events: none;
}
body, #container {
    position: relative;
    z-index: 0;
}
</style>

<div id="bgCanvas"><canvas id="mainCanvas"></canvas></div>

<script>
(function() {
    const canvas = document.getElementById("mainCanvas");
    const ctx = canvas.getContext("2d");

    let width = canvas.width = window.innerWidth;
    let height = canvas.height = window.innerHeight;

    const numStars = 400; // more stars for density
    const stars = [];

    for (let i = 0; i < numStars; i++) {
        stars.push({
            x: Math.random() * width - width/2,
            y: Math.random() * height - height/2,
            z: Math.random() * width,
            prevZ: Math.random() * width
        });
    }

    function draw() {
        ctx.fillStyle = "rgba(0,0,0,0.4)"; // trails fade
        ctx.fillRect(0, 0, width, height);

        ctx.strokeStyle = "#fff"; 
        ctx.lineWidth = 1.2;

        for (let i = 0; i < stars.length; i++) {
            let star = stars[i];
            star.prevZ = star.z;
            star.z -= 6; // speed of movement

            if (star.z <= 1) {
                star.z = width;
                star.x = Math.random() * width - width/2;
                star.y = Math.random() * height - height/2;
                star.prevZ = star.z;
            }

            const sx = (star.x / star.z) * width + width/2;
            const sy = (star.y / star.z) * height + height/2;
            const px = (star.x / star.prevZ) * width + width/2;
            const py = (star.y / star.prevZ) * height + height/2;

            ctx.beginPath();
            ctx.moveTo(px, py);
            ctx.lineTo(sx, sy);
            ctx.stroke();
        }
    }

    setInterval(draw, 30);

    window.addEventListener("resize", () => {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
    });
})();
</script>
<!-- Starfield Background End -->
</head>
<body>

<div id="terminal" tabindex="0">
    <input
        type="text"
        id="hidden-input"
        style="position:fixed;top:0;left:0;width:1px;height:1px;opacity:0;pointer-events:none;caret-color:transparent;"
        autocomplete="off"
        autocorrect="off"
        autocapitalize="off"
        spellcheck="false"
    >
    <div id="output"></div>
    <div>
        <span id="input-line">> </span><span id="user-input"></span><span class="cursor">_</span>
    </div>
</div>

<script>
    const outputDiv = document.getElementById('output');
    const userInputSpan = document.getElementById('user-input');
    const inputLine = document.getElementById('input-line');

const ROOT_DIR = 'root';
let currentDirectory = ROOT_DIR;

const fileSystem = {
    "root": { folders: ["voyager", "moon_signals", "luna_parking", "archives", "action"], files: [] },
    "root/voyager": { folders: ["data", "logs"], files: ["voyager_manifest.txt", "trajectory_plan.txt"] },
    "root/moon_signals": { folders: ["frequency", "decoded"], files: ["pulse_readings.txt", "mystic_patterns.txt"] },
    "root/luna_parking": { folders: [], files: ["queen_dance.mov", "lunar_garden_sketches.txt"] },
    "root/archives": { folders: ["daily", "monthly"], files: ["voyager_backups.zip"] },
    "root/action": { folders: [], files: ["anomaly_detector.zip"] }
};

const fileContents = {
    "voyager_manifest.txt": "Voyager 1 logs: trajectory, cosmic dust readings, distant magnetosphere measurements.",
    "trajectory_plan.txt": "Planned maneuvers, course corrections, and probe orientation instructions for the next 50 years.",
    "pulse_readings.txt": "Encoded pulses from the Moon detected: frequency, amplitude, phase shifts logged for analysis.",
    "mystic_patterns.txt": "Hypothesis: lunar signals correlate with movements from the Queen of the Lunaparking; patterns are cyclical.",
    "queen_dance.mov": "Video of the lunar queen’s mystical dances detected via enhanced optical sensors.",
    "lunar_garden_sketches.txt": "Artist renditions of glowing lunar gardens, created by observers decoding signals from Voyager 1.",
    "voyager_backups.zip": "Compressed archive containing all raw telemetry and decoded lunar signals.",
    "anomaly_detector.zip": {
        type: "executable",
        action: shutdownSequence,
        snippet: "Executable detected: Launching 'anomaly_detector.zip' to decode lunar signals...",
        fullContent: "Signal decryption and visualization sequence initiated..."
    }
};

function generateRandomFiles() {
    const directories = [
        'root/voyager/data',
        'root/moon_signals/frequency',
        'root/moon_signals/decoded',
        'root/archives/daily',
        'root/archives/monthly',
        'root/action/keys',
        'root/action/protocols'
    ];

    directories.forEach(directory => {
        const numFiles = Math.floor(Math.random() * 3) + 1; // 1-3 files
        for (let i = 0; i < numFiles; i++) {
            const fileName = `signal-${Math.floor(Math.random() * 100)}.dat`;
            if (!fileSystem[directory]) fileSystem[directory] = { folders: [], files: [] };
            fileSystem[directory].files.push(fileName);
            fileContents[fileName] = `Encrypted lunar token: ${Math.random().toString(36).substring(2, 15)}`;
        }
    });
}

function showDirectoryContents() {
    const folders = fileSystem[currentDirectory].folders.map(folder => `<span class="folder">${folder}</span>`).join("  ");
    const files = fileSystem[currentDirectory].files.map(file => `<span class="file">${file}</span>`).join("  ");
    
    output(`\nFolders:\n${folders || "None"}\n\nFiles:\n${files || "None"}`);
}

// OUTPUT - END OF LEVEL

function shutdownSequence() {
    output(">>> Initiating signal decryption sequence...");
    setTimeout(() => {
        const terminal = document.getElementById("terminal");

        terminal.innerHTML = `
            <div style="color: #FF00FF; font-size: 2em; text-align: center;"><br><br>Queen of the Lunaparking</div>
            <p style="color: #FF00FF; font-size: 1em; text-align: left; margin-top: 10px;">
            <br><br>>>> Receiving mystical signals from the Moon...<br><br>
            Voyager 1 hums faintly in the void, decoding whispers of cosmic dust and lunar dust motes. 
            Through the veil of space-time, a queen dances atop the Luna parking, her steps bending light and gravity. 
            Each movement sends pulses that shimmer across the Moon’s surface, and somehow, our instruments detect them.<br><br>

            Astronomers marvel, engineers adjust, but none can explain the rhythm — a cadence older than the satellites, 
            a story woven into the craters themselves. Those who witness the signals describe visions of spiraling corridors, 
            glowing panels, and the gentle sway of forgotten lunar gardens illuminated by starlight.<br><br>

            Voyager 1 translates these dances into frequencies, echoing back to Earth: bursts of light, pulses of sound, 
            and mathematical whispers. Each signal a fragment, each fragment a key to understanding a reality simultaneously 
            mystical and mechanical, choreographed by the Queen of the Lunaparking.<br><br>

            Scientists log the data; philosophers speculate on meaning; artists paint the invisible. Yet the Queen remains 
            just beyond reach, spinning cosmic ballet that hints at secrets lost to time. And through it all, the signals keep 
            arriving — constant, enigmatic, and impossibly beautiful.<br><br>

            This is the moment: where Voyager’s lonely ears meet lunar mystery, and humanity watches, humbled and enchanted.<br><br>

            — THE VOYAGER ARCHIVE.

            <br><br>
            <a href="https://filmfreeway.com/lunaparking" style="color: #FF00FF; text-decoration: underline;">Watch Now</a>
            </p>
        `;

        // Jump to the top
        terminal.scrollTop = 0;

        // Disable further input
        // Previously referenced handleKeyDown removed; use hiddenInput.disabled instead
        document.getElementById('hidden-input').disabled = true;
    }, 4000);
}

function openFile(filename) {
    const fileData = fileContents[filename];
    if (fileData) {
        if (fileData.type === "executable" && typeof fileData.action === "function") {
            output(fileData.snippet); // Show a snippet that shutdown is starting
            fileData.action(); // Execute the shutdown sequence
        } else {
            if (fileContents[filename]) {
            output(fileContents[filename]);
            } 
        }
    } else {
        output("<span class='command-color1'>File not found.</span>");
    }
}

    function scrollTerminal() {
        const terminal = document.getElementById("terminal");
        requestAnimationFrame(() => {
            terminal.scrollTop = terminal.scrollHeight;
        });
    }

function output(text) {
    outputDiv.innerHTML += `\n> ${text}\n`;
    scrollTerminal();
}

function processCommand(command) {
    const target = command.trim();
    if (target === "back") {
        if (currentDirectory !== ROOT_DIR) {
            currentDirectory = currentDirectory.split("/").slice(0, -1).join("/") || ROOT_DIR;
            output(`> You are now in ${currentDirectory}`);
            showDirectoryContents();
        } else {
            output("<span class='command-color1'>Already at root.</span>");
        }
    } else if (fileSystem[currentDirectory]?.folders.includes(target)) {
        currentDirectory = `${currentDirectory}/${target}`;
        output(`> You entered ${currentDirectory}`);
        showDirectoryContents();
    } else if (fileSystem[currentDirectory]?.files.includes(target)) {
        output(`> Opening file ${target}...`);
        openFile(target);
    } else {
        output("<span class='command-color1'>Folder or file not found.</span>");
    }
}

    const hiddenInput = document.getElementById('hidden-input');
    // userInputSpan already defined above

    document.getElementById('terminal').addEventListener('click', () => {
        hiddenInput.focus(); // opens mobile keyboard
    });

    hiddenInput.addEventListener('input', () => {
        userInputSpan.innerText = hiddenInput.value;
        scrollTerminal();
    });

    hiddenInput.addEventListener('keydown', (event) => {
        if (event.key === 'Enter') {
            const command = hiddenInput.value;
            output(`<span class='command-color1'>${command}</span>`);
            processCommand(command);
            hiddenInput.value = '';
            userInputSpan.innerText = '';
        } else if (event.key === 'Backspace') {
            // handled automatically by input
        }
    });

function typingAnimation(text, callback) {
    let index = 0;
    const interval = setInterval(() => {
        if (index < text.length) {
            outputDiv.innerHTML += `<span class='command-color1'>${text[index]}</span>`;
            index++;
        } else {
            clearInterval(interval);
            outputDiv.innerHTML += "<br><br>";
            callback();
        }
    }, 100); // typing speed
}

// Call this at startup
typingAnimation(
    `Voyager 1 awakens. Cosmic signals ripple through space, pulses detected from the Moon. 
    The Queen of the Lunaparking dances, sending secret messages across the void. 
    Trace the signals, explore the directories, decode the mysteries...`,
    () => {
        output("Type the name of a <span class='command-color3'>folder</span> or a <span class='command-color2'>file</span> to open it.");
        output("Type <u>back</u> to return to the previous directory.");
        generateRandomFiles();
        showDirectoryContents();
    }
);

    document.addEventListener('contextmenu', (event) => {
        event.preventDefault();
    });

    window.onload = function() {
        document.getElementById("terminal").focus();
    };
</script>

</body>
</html>